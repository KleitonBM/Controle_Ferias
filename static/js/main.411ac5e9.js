(()=>{"use strict";var e={1522(e,t,r){var o=r(1396),l=r(8587),a=r(6665),n=r(3929),d=r(3701),i=r(1690),s=r(530),c=r(1800),f=r(5259);const u=(0,c.createClient)("https://duiryivmrectprzdjpfl.supabase.co","sb_publishable_QnHG86oGJX4MKNYqspyHGw_YLXrylg3",{auth:{storage:f.default,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}});var h=r(4701),g=r(6283),x=r(6773),m=r(9685),b=r(6681),y=r(3454),p=r(8264),j=r(4037),C=r(397);const D="#f4f7f6",T="#f8f8f8",S="#eeeeee",A="#333",w="#666",I="#ff5c8a",k="#f5f5f5",v="#4a61dd",B="#4CAF50",R="#00c7b7",O="#E53935",F="#555555",L="#ffffff",W={A:new Date(2025,11,27),B:new Date(2025,11,29),C:new Date(2025,11,31),D:new Date(2026,0,2)},z=["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],M=[2024,2025,2026,2027,2028,2029,2030];function E(e){if(!e)return null;let t;if("string"===typeof e){const r=e.substring(0,10);if(r.includes("-")){const[e,o,l]=r.split("-").map(Number);t=new Date(e,o-1,l)}else if(r.includes("/")){const[e,o,l]=r.split("/").map(Number);t=new Date(l,o-1,e)}}else t=new Date(e);return!t||isNaN(t.getTime())?null:(t.setHours(0,0,0,0),t)}const N=e=>{try{return e.toISOString().split("T")[0]}catch(t){return""}};function P({employees:e,schedules:t,feristaData:r={},onOpenRegister:o,onOpenMonthly:l,onOpenSchedule:d,onDeleteSchedules:i}){const[s,c]=(0,a.useState)(""),[f,u]=(0,a.useState)(new Date),[D,T]=(0,a.useState)(!1),[A,P]=(0,a.useState)(!1),[G,V]=(0,a.useState)(null),[Y,$]=(0,a.useState)(!1),[_,U]=(0,a.useState)(!0),q=(0,a.useRef)(null),J=(0,a.useRef)(null),X=(0,a.useMemo)(()=>{const r={};return(t||[]).forEach(t=>{const o=E(t.startDate),l=E(t.endDate),a=e.find(e=>e.id===t.employeeId);if(o&&l&&a&&"Ferista"!==a.letra){let e=new Date(o);for(;e<=l;){const t=N(e);r[t]=a.letra,e.setDate(e.getDate()+1)}}}),r},[t,e]),Q=t=>(e||[]).find(e=>e.id===t)||{letra:"A",status:!0},K=(e,t,r)=>{const o=E(e);if(!o)return{saida:"--",retorno:"--",fim:"--"};const l=Q(r),a=e=>Z(e,l.letra).backgroundColor===w?"TRABALHO":"FOLGA";let n=new Date(o);for(n.setDate(n.getDate()-1);"FOLGA"===a(n);)n.setDate(n.getDate()-1);n.setDate(n.getDate()+1);const d=new Date(o);d.setDate(d.getDate()+(parseInt(t)-1));let i=new Date(d);for(i.setDate(i.getDate()+1);"FOLGA"===a(i);)i.setDate(i.getDate()+1);const s=e=>`${String(e.getDate()).padStart(2,"0")}/${String(e.getMonth()+1).padStart(2,"0")}/${e.getFullYear()}`;return{saida:s(n),retorno:s(i),fim:s(d)}},Z=(e,t)=>{const r=W[t]||W.A,o=e.getTime()-r.getTime();return{backgroundColor:(Math.floor(o/864e5)%8+8)%8<4?w:k}},ee=(e,t)=>{if("Ferista"===t.letra||t.nome&&t.nome.toUpperCase().includes("FERISTA")){const t=N(e),o=X[t];if(o)return Z(e,o);const l=r?r[t]:null;if(l){if("TRABALHO"===l.tipo)return{backgroundColor:F};if("FOLGA"===l.tipo)return{backgroundColor:L}}return{backgroundColor:k}}return Z(e,t.letra||"A")},te=e=>{u(new Date(f.getFullYear(),f.getMonth()+e,1))},re=Array.from({length:42},(e,t)=>{const r=new Date(f.getFullYear(),f.getMonth(),1);return r.setDate(r.getDate()+t),r}),oe=(t||[]).filter(e=>{if(!1===Q(e.employeeId).status)return!1;const t=e.employeeName?.toLowerCase().includes(s.toLowerCase()),r=E(e.startDate),o=r&&(r.getMonth()===f.getMonth()||r.getMonth()===f.getMonth()+1);return t&&o}),le=(e||[]).filter(e=>!0===e.status&&e.nome?.toLowerCase().includes(s.toLowerCase()));return(0,C.jsxs)(h.default,{style:H.container,children:[(0,C.jsx)(p.default,{visible:D||A,transparent:!0,animationType:"fade",children:(0,C.jsx)(m.default,{style:H.modalOverlay,onPress:()=>{T(!1),P(!1)},children:(0,C.jsx)(n.default,{style:H.modalContent,children:(D?z:M).map((e,t)=>(0,C.jsx)(m.default,{style:H.modalItem,onPress:()=>{u(D?new Date(f.getFullYear(),t,1):new Date(e,f.getMonth(),1)),T(!1),P(!1)},children:(0,C.jsx)(g.default,{style:H.modalText,children:e})},e))})})}),(0,C.jsx)(p.default,{visible:!!G&&!Y,transparent:!0,animationType:"slide",children:(0,C.jsx)(m.default,{style:H.modalOverlay,onPress:()=>V(null),children:(0,C.jsxs)(n.default,{style:H.editModalContent,children:[(0,C.jsx)(g.default,{style:H.editModalTitle,children:"Op\xe7\xf5es do Agendamento"}),G&&(0,C.jsx)(n.default,{style:H.infoRowModal,children:(()=>{const e=K(G.startDate,G.durationDays,G.employeeId);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(n.default,{style:H.detailBox,children:[(0,C.jsx)(g.default,{style:[H.infoLabel,{color:v}],children:"SA\xcdDA"}),(0,C.jsx)(g.default,{style:H.infoValue,children:e.saida})]}),(0,C.jsx)(n.default,{style:H.detailDivider}),(0,C.jsxs)(n.default,{style:H.detailRow,children:[(0,C.jsxs)(n.default,{style:H.detailItem,children:[(0,C.jsx)(g.default,{style:H.infoLabel,children:"IN\xcdCIO"}),(0,C.jsx)(g.default,{style:H.infoValue,children:G.startDate})]}),(0,C.jsxs)(n.default,{style:H.detailItem,children:[(0,C.jsx)(g.default,{style:H.infoLabel,children:"RETORNO"}),(0,C.jsx)(g.default,{style:[H.infoValue,{color:B}],children:e.retorno})]})]})]})})()}),(0,C.jsx)(m.default,{style:[H.editBtn,{backgroundColor:"#FF9800",marginBottom:10}],onPress:()=>{const e=G;V(null),d(e)},children:(0,C.jsx)(g.default,{style:H.btnT,children:"EDITAR"})}),(0,C.jsx)(m.default,{style:[H.editBtn,{backgroundColor:O}],onPress:()=>$(!0),children:(0,C.jsx)(g.default,{style:H.btnT,children:"EXCLUIR"})})]})})}),(0,C.jsx)(p.default,{visible:Y,transparent:!0,animationType:"fade",children:(0,C.jsx)(n.default,{style:H.modalOverlay,children:(0,C.jsxs)(n.default,{style:H.confirmBox,children:[(0,C.jsx)(g.default,{style:H.confirmTitle,children:"Confirmar Exclus\xe3o?"}),(0,C.jsxs)(n.default,{style:H.confirmActions,children:[(0,C.jsx)(m.default,{style:[H.confirmBtn,{backgroundColor:S}],onPress:()=>$(!1),children:(0,C.jsx)(g.default,{children:"N\xc3O"})}),(0,C.jsx)(m.default,{style:[H.confirmBtn,{backgroundColor:O}],onPress:async()=>{i&&G&&await i([G.id]),$(!1),V(null)},children:(0,C.jsx)(g.default,{style:H.btnT,children:"SIM, EXCLUIR"})})]})]})})}),(0,C.jsxs)(n.default,{style:H.mainHeader,children:[(0,C.jsxs)(n.default,{children:[(0,C.jsx)(g.default,{style:H.mainTitle,children:"Equipe Turn\xe3o"}),(0,C.jsxs)(g.default,{style:H.mainSub,children:[z[f.getMonth()]," de ",f.getFullYear()]})]}),(0,C.jsx)(j.default,{value:_,onValueChange:U,trackColor:{false:"#ddd",true:v}})]}),(0,C.jsxs)(n.default,{style:H.topBar,children:[(0,C.jsxs)(n.default,{style:H.navRow,children:[(0,C.jsx)(m.default,{style:H.arrowBtn,onPress:()=>te(-1),children:(0,C.jsx)(g.default,{style:H.arrowText,children:"\u25c0"})}),(0,C.jsx)(m.default,{style:H.dateDisplay,onPress:()=>T(!0),children:(0,C.jsx)(g.default,{style:H.dateDisplayText,children:z[f.getMonth()]})}),(0,C.jsx)(m.default,{style:H.dateDisplay,onPress:()=>P(!0),children:(0,C.jsx)(g.default,{style:H.dateDisplayText,children:f.getFullYear()})}),(0,C.jsx)(m.default,{style:H.arrowBtn,onPress:()=>te(1),children:(0,C.jsx)(g.default,{style:H.arrowText,children:"\u25b6"})})]}),(0,C.jsx)(x.default,{placeholder:"Buscar Balanceiro...",style:H.input,onChangeText:c,value:s})]}),(0,C.jsx)(n.default,{style:{flex:1},children:_?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(n.default,{style:H.stickyHeaderContainer,children:[(0,C.jsx)(n.default,{style:H.namesHeaderCorner,children:(0,C.jsx)(g.default,{style:{fontSize:10,color:w,fontWeight:"bold"},children:"BALANCEIROS"})}),(0,C.jsx)(y.default,{horizontal:!0,ref:q,scrollEnabled:!1,showsHorizontalScrollIndicator:!1,style:H.headerScroll,children:(0,C.jsx)(n.default,{style:H.daysHeader,children:re.map(e=>(0,C.jsx)(n.default,{style:H.dayBox,children:(0,C.jsxs)(g.default,{style:H.dayLabel,children:[String(e.getDate()).padStart(2,"0"),"/",String(e.getMonth()+1).padStart(2,"0")]})},e.getTime()))})})]}),(0,C.jsx)(y.default,{style:{flex:1},contentContainerStyle:{flexGrow:1},children:(0,C.jsxs)(n.default,{style:H.mainTimelineContainer,children:[(0,C.jsx)(n.default,{style:H.namesColumn,children:le.map(e=>(0,C.jsxs)(n.default,{style:H.nameRow,children:[(0,C.jsx)(g.default,{style:H.nameText,numberOfLines:1,children:e.nome}),(0,C.jsx)(g.default,{style:{fontSize:8,color:v},children:"Ferista"===e.letra?"FERISTA":`Letra ${e.letra}`})]},e.id))}),(0,C.jsx)(y.default,{horizontal:!0,ref:J,style:H.gridScroll,onScroll:e=>{const t=e.nativeEvent.contentOffset.x;q.current&&q.current.scrollTo({x:t,animated:!1})},scrollEventThrottle:16,children:(0,C.jsx)(n.default,{children:le.map(e=>(0,C.jsxs)(n.default,{style:H.row,children:[re.map(t=>(0,C.jsx)(n.default,{style:[H.cell,ee(t,e)]},t.getTime())),(t||[]).filter(t=>t.employeeId===e.id).map(e=>{const t=E(e.startDate),r=E(e.endDate);if(!t||!r)return null;let o=re.findIndex(e=>e.getTime()===t.getTime()),l=re.findIndex(e=>e.getTime()===r.getTime());if(-1===l&&r<re[0])return null;if(-1===o&&t>re[re.length-1])return null;const a=-1===o?0:o,n=-1===l?re.length-1:l;return(0,C.jsx)(m.default,{onPress:()=>V(e),style:[H.bar,{left:50*a,width:50*(n-a+1),backgroundColor:I}],children:(0,C.jsx)(g.default,{style:H.barText,numberOfLines:1,children:"F\xc9RIAS"})},e.id)})]},e.id))})})]})})]}):(0,C.jsx)(b.default,{data:oe,keyExtractor:e=>e.id,contentContainerStyle:{padding:15},renderItem:({item:e})=>{const t=K(e.startDate,e.durationDays,e.employeeId),r=Q(e.employeeId);return(0,C.jsxs)(n.default,{style:H.card,children:[(0,C.jsx)(n.default,{style:[H.statusIndicator,{backgroundColor:v}]}),(0,C.jsxs)(n.default,{style:H.cardContent,children:[(0,C.jsxs)(n.default,{style:H.cardHeader,children:[(0,C.jsxs)(n.default,{children:[(0,C.jsx)(g.default,{style:H.empName,children:e.employeeName}),(0,C.jsxs)(g.default,{style:{fontSize:10,color:v,fontWeight:"bold"},children:["Letra ",r.letra]})]}),(0,C.jsx)(m.default,{onPress:()=>V(e),children:(0,C.jsx)(g.default,{style:{fontSize:18},children:"\u2699\ufe0f"})})]}),(0,C.jsxs)(n.default,{style:H.datesGrid,children:[(0,C.jsxs)(n.default,{style:H.dateBlock,children:[(0,C.jsx)(g.default,{style:H.dateLabel,children:"SA\xcdDA"}),(0,C.jsx)(g.default,{style:[H.dateValue,{color:v}],children:t.saida})]}),(0,C.jsxs)(n.default,{style:H.dateBlock,children:[(0,C.jsx)(g.default,{style:H.dateLabel,children:"IN\xcdCIO"}),(0,C.jsx)(g.default,{style:H.dateValue,children:e.startDate})]}),(0,C.jsxs)(n.default,{style:H.dateBlock,children:[(0,C.jsx)(g.default,{style:H.dateLabel,children:"RETORNO"}),(0,C.jsx)(g.default,{style:[H.dateValue,{color:B}],children:t.retorno})]})]})]})]})}})}),(0,C.jsxs)(n.default,{style:H.footer,children:[(0,C.jsx)(m.default,{style:[H.btn,{backgroundColor:v}],onPress:o,children:(0,C.jsx)(g.default,{style:H.btnT,children:"+ Func"})}),(0,C.jsx)(m.default,{style:[H.btn,{backgroundColor:B}],onPress:()=>d(null),children:(0,C.jsx)(g.default,{style:H.btnT,children:"Agendar"})}),(0,C.jsx)(m.default,{style:[H.btn,{backgroundColor:R}],onPress:l,children:(0,C.jsx)(g.default,{style:H.btnT,children:"Mensal"})})]})]})}const H=d.default.create({container:{flex:1,backgroundColor:D},mainHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:20,backgroundColor:"#fff",borderBottomWidth:1,borderColor:S},mainTitle:{fontSize:20,fontWeight:"bold"},mainSub:{fontSize:12,color:w},topBar:{padding:15,backgroundColor:"#fff",borderBottomWidth:1,borderColor:S},navRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:10,gap:5},arrowBtn:{padding:10,backgroundColor:"#f9f9f9",borderRadius:8,borderWidth:1,borderColor:S},arrowText:{color:v,fontWeight:"bold"},dateDisplay:{flex:1,backgroundColor:"#f9f9f9",borderRadius:8,borderWidth:1,borderColor:S,justifyContent:"center",alignItems:"center"},dateDisplayText:{color:v,fontWeight:"bold",fontSize:13},input:{borderWidth:1,borderColor:S,padding:10,borderRadius:8,backgroundColor:"#f9f9f9"},stickyHeaderContainer:{flexDirection:"row",height:40,borderBottomWidth:1,borderColor:S,backgroundColor:T,zIndex:10},namesHeaderCorner:{width:140,borderRightWidth:1,borderColor:S,backgroundColor:"#fff",justifyContent:"center",alignItems:"center"},headerScroll:{flex:1},mainTimelineContainer:{flexDirection:"row"},namesColumn:{width:140,borderRightWidth:1,borderColor:S,backgroundColor:"#fff",zIndex:5},gridScroll:{flex:1},nameRow:{height:60,padding:5,borderBottomWidth:1,borderColor:S,justifyContent:"center"},nameText:{fontWeight:"bold",fontSize:12},daysHeader:{flexDirection:"row",height:40,backgroundColor:T},dayBox:{width:50,alignItems:"center",justifyContent:"center",borderRightWidth:1,borderColor:S},dayLabel:{fontSize:10,fontWeight:"bold",color:A},row:{height:60,flexDirection:"row",borderBottomWidth:1,borderColor:S,position:"relative"},cell:{width:50,height:"100%",borderRightWidth:1,borderColor:S},bar:{position:"absolute",height:30,top:15,borderRadius:4,justifyContent:"center",alignItems:"center",zIndex:10,opacity:.9},barText:{color:"#fff",fontSize:9,fontWeight:"bold",paddingHorizontal:2},card:{backgroundColor:"#fff",borderRadius:15,marginBottom:15,flexDirection:"row",elevation:3},statusIndicator:{width:6,borderTopLeftRadius:15,borderBottomLeftRadius:15},cardContent:{flex:1,padding:15},cardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},empName:{fontSize:16,fontWeight:"bold"},datesGrid:{flexDirection:"row",justifyContent:"space-between",paddingVertical:10,borderTopWidth:1,borderBottomWidth:1,borderColor:"#f5f5f5"},dateBlock:{alignItems:"center"},dateLabel:{fontSize:8,fontWeight:"bold",color:w},dateValue:{fontSize:12,fontWeight:"bold"},footer:{padding:10,flexDirection:"row",gap:8,backgroundColor:"#fff",borderTopWidth:1,borderColor:S},btn:{flex:1,paddingVertical:12,borderRadius:8,alignItems:"center"},btnT:{color:"#fff",fontWeight:"bold",fontSize:11},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:"#fff",width:"40%",borderRadius:12,padding:10},modalItem:{padding:15,borderBottomWidth:1,borderBottomColor:S},modalText:{textAlign:"center",fontSize:16},editModalContent:{backgroundColor:"#fff",width:"85%",borderRadius:20,padding:25,alignItems:"center"},editModalTitle:{fontSize:18,fontWeight:"bold",marginBottom:15},infoRowModal:{backgroundColor:T,padding:15,borderRadius:15,width:"100%",marginBottom:20},detailBox:{alignItems:"center",paddingVertical:10},detailRow:{flexDirection:"row",justifyContent:"space-between",paddingVertical:10},detailItem:{alignItems:"center",flex:1},detailDivider:{height:1,backgroundColor:"#f0f0f0",width:"100%"},infoLabel:{fontSize:8,fontWeight:"bold",color:w,marginBottom:4},infoValue:{fontSize:16,fontWeight:"bold",color:A},editBtn:{width:"100%",padding:15,borderRadius:10,alignItems:"center"},confirmBox:{backgroundColor:"#fff",width:"80%",padding:20,borderRadius:15,alignItems:"center"},confirmTitle:{fontSize:18,fontWeight:"bold",color:O,marginBottom:20},confirmActions:{flexDirection:"row",gap:10},confirmBtn:{flex:1,padding:12,borderRadius:8,alignItems:"center"}}),G="#ffffff",V="#f8f8f8",Y="#eeeeee",$="#666",_="#4a61dd",U="#4CAF50",q="#666",J="#f9f9f9",X="#1b5e20",Q="#d32f2f",K={A:new Date(2025,11,27),B:new Date(2025,11,29),C:new Date(2025,11,31),D:new Date(2026,0,2)};function Z({employees:e,schedules:t,onSchedule:r,onCancel:o}){const[l,d]=(0,a.useState)(!1),[s,c]=(0,a.useState)(null),[f,u]=(0,a.useState)(""),[D,T]=(0,a.useState)(""),[S,A]=(0,a.useState)("20"),[w,I]=(0,a.useState)(!1),[k,v]=(0,a.useState)({saidaReal:"",inicioOficial:"",termino:"",retorno:"",proximaDisponivel:"",erroFolga:!1,erroGeral:""}),B=e=>{if(!e||e.length<10)return new Date(NaN);const[t,r,o]=e.split("/").map(Number);return new Date(o,r-1,t)},R=e=>`${String(e.getDate()).padStart(2,"0")}/${String(e.getMonth()+1).padStart(2,"0")}/${e.getFullYear()}`,O=(e,t="A")=>{const r=K[t]||K.A,o=new Date(e);o.setHours(0,0,0,0);const l=o.getTime()-r.getTime();return(Math.floor(l/864e5)%8+8)%8<4?"TRABALHO":"FOLGA"},F=(e,r,o,l)=>{if(!e||isNaN(r.getTime()))return{ok:!1,msg:""};const a=e.admissao.includes("-")?e.admissao.split("-"):e.admissao.split("/"),n=e.admissao.includes("-")?new Date(a[0],a[1]-1,a[2]):new Date(a[2],a[1]-1,a[0]);let d=r.getFullYear()-n.getFullYear();if((r.getMonth()<n.getMonth()||r.getMonth()===n.getMonth()&&r.getDate()<n.getDate())&&d--,d<1)return{ok:!1,msg:"Ainda n\xe3o completou o 1\xba per\xedodo aquisitivo."};(t||[]).some(t=>{if(t.employeeId!==e.id)return!1;const r=B(t.startDate);let o=r.getFullYear()-n.getFullYear();return(r.getMonth()<n.getMonth()||r.getMonth()===n.getMonth()&&r.getDate()<n.getDate())&&o--,o===d});return o+l>30?{ok:!1,msg:"Soma de gozo e venda excede 30 dias."}:{ok:!0,msg:""}};(0,a.useEffect)(()=>{if(s&&10===D.length&&S){const e=B(D),t=F(s,e,parseInt(S)||0,w?10:0),r="FOLGA"===O(e,s.letra);let o="";if(r){let t=new Date(e);for(;"FOLGA"===O(t,s.letra);)t.setDate(t.getDate()+1);o=R(t)}let l=new Date(e);for(l.setDate(l.getDate()-1);"FOLGA"===O(l,s.letra);)l.setDate(l.getDate()-1);l.setDate(l.getDate()+1);const a=new Date(e);a.setDate(a.getDate()+(parseInt(S)||0)-1);let n=new Date(a);for(n.setDate(n.getDate()+1);"TRABALHO"!==O(n,s.letra);)n.setDate(n.getDate()+1);v({saidaReal:R(l),inicioOficial:R(e),termino:R(a),retorno:R(n),proximaDisponivel:o,erroFolga:r,erroGeral:t.msg})}},[D,S,w,s,t]);return(0,C.jsxs)(h.default,{style:ee.container,children:[(0,C.jsx)(p.default,{visible:l,transparent:!0,animationType:"fade",children:(0,C.jsx)(n.default,{style:ee.modalOverlay,children:(0,C.jsxs)(n.default,{style:ee.modalContent,children:[(0,C.jsx)(g.default,{style:ee.modalTitle,children:"Selecionar Colaborador Ativo"}),(0,C.jsx)(x.default,{style:ee.modalSearchInput,placeholder:"Pesquisar...",onChangeText:u}),(0,C.jsx)(b.default,{data:e.filter(e=>!0===e.status&&e.nome.toLowerCase().includes(f.toLowerCase())),keyExtractor:e=>e.id,renderItem:({item:e})=>(0,C.jsxs)(m.default,{style:ee.modalItem,onPress:()=>{c(e),d(!1)},children:[(0,C.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between"},children:[(0,C.jsx)(g.default,{style:ee.modalText,children:e.nome}),(0,C.jsxs)(g.default,{style:{fontWeight:"bold",color:_},children:["Grupo ",e.letra]})]}),(0,C.jsxs)(g.default,{style:ee.modalSubText,children:["Admiss\xe3o: ",e.admissao]})]})}),(0,C.jsx)(m.default,{style:ee.closeBtn,onPress:()=>d(!1),children:(0,C.jsx)(g.default,{style:{fontWeight:"bold"},children:"CANCELAR"})})]})})}),(0,C.jsx)(n.default,{style:ee.header,children:(0,C.jsx)(g.default,{style:ee.headerTitle,children:"Agendar F\xe9rias"})}),(0,C.jsxs)(y.default,{style:ee.form,keyboardShouldPersistTaps:"handled",children:[(0,C.jsx)(m.default,{style:ee.comboButton,onPress:()=>d(!0),children:(0,C.jsx)(g.default,{style:s?{fontWeight:"bold"}:{color:$},children:s?`${s.nome} (Grupo ${s.letra})`:"Selecione o funcion\xe1rio ativo..."})}),(0,C.jsxs)(n.default,{style:ee.vendaRow,children:[(0,C.jsxs)(n.default,{style:{flex:1},children:[(0,C.jsx)(g.default,{style:ee.vendaTitle,children:"Venda de F\xe9rias (Abono)"}),(0,C.jsx)(g.default,{style:ee.vendaSub,children:"Vender 10 dias do saldo anual"})]}),(0,C.jsx)(j.default,{value:w,onValueChange:I,trackColor:{false:"#ddd",true:_}})]}),(0,C.jsxs)(n.default,{style:ee.row,children:[(0,C.jsxs)(n.default,{style:{flex:1},children:[(0,C.jsx)(g.default,{style:ee.label,children:"In\xedcio das F\xe9rias"}),(0,C.jsx)(x.default,{style:[ee.input,(k.erroFolga||k.erroGeral)&&{borderColor:Q,borderWidth:2}],placeholder:"DD/MM/AAAA",keyboardType:"numeric",maxLength:10,value:D,onChangeText:e=>{let t=e.replace(/\D/g,"");t.length>2&&(t=t.slice(0,2)+"/"+t.slice(2)),t.length>5&&(t=t.slice(0,5)+"/"+t.slice(5,9)),T(t)}})]}),(0,C.jsx)(n.default,{style:{width:15}}),(0,C.jsxs)(n.default,{style:{flex:1},children:[(0,C.jsx)(g.default,{style:ee.label,children:"Dias de Gozo"}),(0,C.jsx)(x.default,{style:ee.input,placeholder:"Qtd",keyboardType:"numeric",value:S,onChangeText:A})]})]}),k.erroGeral?(0,C.jsx)(n.default,{style:ee.errorCard,children:(0,C.jsxs)(g.default,{style:ee.errorText,children:["\u26a0\ufe0f ",k.erroGeral]})}):null,k.erroFolga&&(0,C.jsxs)(n.default,{style:ee.errorCard,children:[(0,C.jsxs)(g.default,{style:ee.errorText,children:["\u274c In\xedcio em dia de FOLGA (Escala ",s?.letra,") n\xe3o permitido."]}),(0,C.jsx)(m.default,{onPress:()=>T(k.proximaDisponivel),children:(0,C.jsxs)(g.default,{style:ee.suggestionText,children:["Sugest\xe3o: ",k.proximaDisponivel," (Aplicar)"]})})]}),k.termino&&!k.erroFolga&&!k.erroGeral&&(0,C.jsxs)(n.default,{style:{marginTop:20},children:[(0,C.jsxs)(n.default,{style:[ee.card,{backgroundColor:"#e3f2fd"}],children:[(0,C.jsx)(g.default,{style:ee.cardLab,children:"SA\xcdDA ANTECIPADA (FOLGA)"}),(0,C.jsx)(g.default,{style:[ee.cardVal,{color:_}],children:k.saidaReal})]}),(0,C.jsxs)(n.default,{style:ee.row,children:[(0,C.jsxs)(n.default,{style:[ee.card,{flex:1}],children:[(0,C.jsx)(g.default,{style:ee.cardLab,children:"IN\xcdCIO OFICIAL"}),(0,C.jsx)(g.default,{style:ee.cardVal,children:k.inicioOficial})]}),(0,C.jsx)(n.default,{style:{width:10}}),(0,C.jsxs)(n.default,{style:[ee.card,{flex:1}],children:[(0,C.jsx)(g.default,{style:ee.cardLab,children:"\xdaLTIMO DIA"}),(0,C.jsx)(g.default,{style:ee.cardVal,children:k.termino})]})]}),(0,C.jsxs)(n.default,{style:[ee.card,{backgroundColor:"#e8f5e9"}],children:[(0,C.jsx)(g.default,{style:ee.cardLab,children:"RETORNO AO TRABALHO (1\xaa ESCALA)"}),(0,C.jsx)(g.default,{style:[ee.cardVal,{color:X}],children:k.retorno})]})]}),(0,C.jsxs)(n.default,{style:ee.actions,children:[(0,C.jsx)(m.default,{style:[ee.btn,{backgroundColor:q}],onPress:o,children:(0,C.jsx)(g.default,{style:ee.btnT,children:"CANCELAR"})}),(0,C.jsx)(m.default,{style:[ee.btn,{backgroundColor:U,opacity:!k.termino||k.erroFolga||k.erroGeral?.5:1}],onPress:()=>{console.log("passou aqui");const e=B(D),t=F(s,e,parseInt(S)||0,w?10:0);t.ok?k.erroFolga?i.default.alert("Erro","N\xe3o \xe9 permitido iniciar f\xe9rias em dias de folga."):r({employeeId:s.id,employeeName:s.nome,startDate:k.inicioOficial,endDate:k.termino,durationDays:parseInt(S),abonoPecuniario:w,diasVendidos:w?10:0}):i.default.alert("Agendamento Negado",t.msg)},disabled:!k.termino||k.erroFolga||!!k.erroGeral,children:(0,C.jsx)(g.default,{style:ee.btnT,children:"SALVAR"})})]})]})]})}const ee=d.default.create({container:{flex:1,backgroundColor:G},header:{padding:20,backgroundColor:V,borderBottomWidth:1,borderColor:Y,alignItems:"center"},headerTitle:{fontSize:18,fontWeight:"bold"},form:{padding:20},label:{fontSize:13,fontWeight:"bold",marginTop:15,marginBottom:5},comboButton:{backgroundColor:J,padding:18,borderRadius:12,borderWidth:1,borderColor:Y},vendaRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#f0f4ff",padding:15,borderRadius:12,marginTop:15,borderWidth:1,borderColor:"#d0d9ff"},vendaTitle:{fontSize:14,fontWeight:"bold",color:_},vendaSub:{fontSize:11,color:$},input:{backgroundColor:J,padding:15,borderRadius:10,borderWidth:1,borderColor:Y,fontSize:16},row:{flexDirection:"row",marginTop:10},errorCard:{backgroundColor:"#ffebee",padding:15,borderRadius:10,marginTop:15,borderWidth:1,borderColor:"#ef9a9a"},errorText:{color:Q,fontWeight:"bold",textAlign:"center",fontSize:12},suggestionText:{color:_,textAlign:"center",marginTop:5,fontWeight:"bold",textDecorationLine:"underline"},card:{padding:15,borderRadius:12,borderWidth:1,borderColor:Y,alignItems:"center",marginVertical:5,backgroundColor:"#fff"},cardLab:{fontSize:9,fontWeight:"bold",color:"#666"},cardVal:{fontSize:18,fontWeight:"bold"},actions:{flexDirection:"row",gap:10,marginTop:30,marginBottom:50},btn:{flex:1,padding:18,borderRadius:12,alignItems:"center"},btnT:{color:"#fff",fontWeight:"bold"},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.6)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:"#fff",width:"90%",borderRadius:20,padding:20,maxHeight:"80%"},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:15,textAlign:"center"},modalSearchInput:{backgroundColor:J,padding:12,borderRadius:10,marginBottom:15,borderWidth:1,borderColor:Y},modalItem:{paddingVertical:15,borderBottomWidth:1,borderBottomColor:Y},modalText:{fontSize:16},modalSubText:{fontSize:12,color:$},closeBtn:{marginTop:20,padding:10,alignItems:"center"}}),te="#ffffff",re="#f8f8f8",oe="#eeeeee",le="#666",ae="#4a61dd",ne="#4CAF50",de="#666",ie="#f9f9f9",se="#1b5e20",ce="#d32f2f",fe=new Date(2025,11,27);function ue({scheduleToEdit:e,employees:t,schedules:r,onUpdate:o,onCancel:l}){if(!e)return null;const d=(t||[]).find(t=>t.id===e.employeeId),[i,s]=(0,a.useState)(e.startDate||""),[c,f]=(0,a.useState)(String(e.durationDays||"")),[u,b]=(0,a.useState)(e.abonoPecuniario||!1),[p,D]=(0,a.useState)({saidaReal:"",inicioOficial:"",termino:"",retorno:"",proximaDisponivel:"",erroFolga:!1,erroGeral:""}),T=e=>{if(!e||e.length<10)return new Date(NaN);const[t,r,o]=e.split("/").map(Number);return new Date(o,r-1,t)},S=e=>`${String(e.getDate()).padStart(2,"0")}/${String(e.getMonth()+1).padStart(2,"0")}/${e.getFullYear()}`,A=e=>{const t=new Date(e);t.setHours(0,0,0,0);const r=t.getTime()-fe.getTime();return(Math.floor(r/864e5)%8+8)%8<4?"TRABALHO":"FOLGA"};(0,a.useEffect)(()=>{if(d&&10===i.length&&c){const t=T(i),o=((t,o,l,a)=>{if(!t||isNaN(o.getTime()))return{ok:!1,msg:""};const n=t.admissao.split(/[-/]/),d=new Date(4===n[0].length?n[0]:n[2],n[1]-1,4===n[0].length?n[2]:n[0]);let i=o.getFullYear()-d.getFullYear();return(o.getMonth()<d.getMonth()||o.getMonth()===d.getMonth()&&o.getDate()<d.getDate())&&i--,i<1?{ok:!1,msg:"Per\xedodo aquisitivo ainda n\xe3o completado."}:(r||[]).some(t=>{if(t.id===e.id)return!1;const r=T(t.startDate);let o=r.getFullYear()-d.getFullYear();return(r.getMonth()<d.getMonth()||r.getMonth()===d.getMonth()&&r.getDate()<d.getDate())&&o--,o===i})?{ok:!1,msg:`J\xe1 existe outro agendamento diferente para o ciclo de ${o.getFullYear()}.`}:l+a>30?{ok:!1,msg:"Soma de gozo e venda excede 30 dias."}:{ok:!0,msg:""}})(d,t,parseInt(c)||0,u?10:0),l="FOLGA"===A(t);let a="";if(l){let e=new Date(t);for(;"FOLGA"===A(e);)e.setDate(e.getDate()+1);a=S(e)}let n=new Date(t);for(n.setDate(n.getDate()-1);"FOLGA"===A(n);)n.setDate(n.getDate()-1);n.setDate(n.getDate()+1);const s=new Date(t);s.setDate(s.getDate()+(parseInt(c)||0)-1);let f=new Date(s);for(f.setDate(f.getDate()+1);"TRABALHO"!==A(f);)f.setDate(f.getDate()+1);D({saidaReal:S(n),inicioOficial:S(t),termino:S(s),retorno:S(f),proximaDisponivel:a,erroFolga:l,erroGeral:o.msg})}},[i,c,u,r]);return(0,C.jsxs)(h.default,{style:he.container,children:[(0,C.jsx)(n.default,{style:he.header,children:(0,C.jsxs)(g.default,{style:he.headerTitle,children:["Editar F\xe9rias: ",d?.nome]})}),(0,C.jsxs)(y.default,{style:he.form,keyboardShouldPersistTaps:"handled",children:[(0,C.jsxs)(n.default,{style:he.vendaRow,children:[(0,C.jsxs)(n.default,{style:{flex:1},children:[(0,C.jsx)(g.default,{style:he.vendaTitle,children:"Venda de F\xe9rias (Abono)"}),(0,C.jsx)(g.default,{style:he.vendaSub,children:"Vender 10 dias do saldo anual"})]}),(0,C.jsx)(j.default,{value:u,onValueChange:b,trackColor:{false:"#ddd",true:ae}})]}),(0,C.jsxs)(n.default,{style:he.row,children:[(0,C.jsxs)(n.default,{style:{flex:1},children:[(0,C.jsx)(g.default,{style:he.label,children:"In\xedcio das F\xe9rias"}),(0,C.jsx)(x.default,{style:[he.input,(p.erroFolga||p.erroGeral)&&{borderColor:ce,borderWidth:2}],placeholder:"DD/MM/AAAA",keyboardType:"numeric",maxLength:10,value:i,onChangeText:e=>{let t=e.replace(/\D/g,"");t.length>2&&(t=t.slice(0,2)+"/"+t.slice(2)),t.length>5&&(t=t.slice(0,5)+"/"+t.slice(5,9)),s(t)}})]}),(0,C.jsx)(n.default,{style:{width:15}}),(0,C.jsxs)(n.default,{style:{flex:1},children:[(0,C.jsx)(g.default,{style:he.label,children:"Dias de Gozo"}),(0,C.jsx)(x.default,{style:he.input,placeholder:"Qtd",keyboardType:"numeric",value:c,onChangeText:f})]})]}),p.erroGeral?(0,C.jsx)(n.default,{style:he.errorCard,children:(0,C.jsxs)(g.default,{style:he.errorText,children:["\u26a0\ufe0f ",p.erroGeral]})}):null,p.erroFolga&&(0,C.jsxs)(n.default,{style:he.errorCard,children:[(0,C.jsx)(g.default,{style:he.errorText,children:"\u274c In\xedcio em FOLGA n\xe3o permitido."}),(0,C.jsx)(m.default,{onPress:()=>s(p.proximaDisponivel),children:(0,C.jsxs)(g.default,{style:he.suggestionText,children:["Sugest\xe3o: ",p.proximaDisponivel," (Aplicar)"]})})]}),p.termino&&!p.erroFolga&&!p.erroGeral&&(0,C.jsxs)(n.default,{style:{marginTop:20},children:[(0,C.jsxs)(n.default,{style:[he.card,{backgroundColor:"#e3f2fd"}],children:[(0,C.jsx)(g.default,{style:he.cardLab,children:"SA\xcdDA ANTECIPADA (FOLGA)"}),(0,C.jsx)(g.default,{style:[he.cardVal,{color:ae}],children:p.saidaReal})]}),(0,C.jsxs)(n.default,{style:he.row,children:[(0,C.jsxs)(n.default,{style:[he.card,{flex:1}],children:[(0,C.jsx)(g.default,{style:he.cardLab,children:"IN\xcdCIO OFICIAL"}),(0,C.jsx)(g.default,{style:he.cardVal,children:p.inicioOficial})]}),(0,C.jsx)(n.default,{style:{width:10}}),(0,C.jsxs)(n.default,{style:[he.card,{flex:1}],children:[(0,C.jsx)(g.default,{style:he.cardLab,children:"\xdaLTIMO DIA"}),(0,C.jsx)(g.default,{style:he.cardVal,children:p.termino})]})]}),(0,C.jsxs)(n.default,{style:[he.card,{backgroundColor:"#e8f5e9"}],children:[(0,C.jsx)(g.default,{style:he.cardLab,children:"RETORNO AO TRABALHO (1\xaa ESCALA)"}),(0,C.jsx)(g.default,{style:[he.cardVal,{color:se}],children:p.retorno})]})]}),(0,C.jsxs)(n.default,{style:he.actions,children:[(0,C.jsx)(m.default,{style:[he.btn,{backgroundColor:de}],onPress:l,children:(0,C.jsx)(g.default,{style:he.btnT,children:"CANCELAR"})}),(0,C.jsx)(m.default,{style:[he.btn,{backgroundColor:ne,opacity:!p.termino||p.erroFolga||p.erroGeral?.5:1}],onPress:()=>{p.erroGeral||p.erroFolga||o(Object.assign({},e,{startDate:p.inicioOficial,endDate:p.termino,durationDays:parseInt(c),abonoPecuniario:u,diasVendidos:u?10:0}))},disabled:!p.termino||p.erroFolga||!!p.erroGeral,children:(0,C.jsx)(g.default,{style:he.btnT,children:"SALVAR ALTERA\xc7\xd5ES"})})]})]})]})}const he=d.default.create({container:{flex:1,backgroundColor:te},header:{padding:20,backgroundColor:re,borderBottomWidth:1,borderColor:oe,alignItems:"center"},headerTitle:{fontSize:18,fontWeight:"bold"},form:{padding:20},label:{fontSize:13,fontWeight:"bold",marginTop:15,marginBottom:5},vendaRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#f0f4ff",padding:15,borderRadius:12,marginTop:15},vendaTitle:{fontSize:14,fontWeight:"bold",color:ae},vendaSub:{fontSize:11,color:le},input:{backgroundColor:ie,padding:15,borderRadius:10,borderWidth:1,borderColor:oe,fontSize:16},row:{flexDirection:"row",marginTop:10},errorCard:{backgroundColor:"#ffebee",padding:15,borderRadius:10,marginTop:15,borderWidth:1,borderColor:"#ef9a9a"},errorText:{color:ce,fontWeight:"bold",textAlign:"center",fontSize:12},suggestionText:{color:ae,textAlign:"center",marginTop:5,fontWeight:"bold"},card:{padding:15,borderRadius:12,borderWidth:1,borderColor:oe,alignItems:"center",marginVertical:5,backgroundColor:"#fff"},cardLab:{fontSize:9,fontWeight:"bold",color:"#666"},cardVal:{fontSize:18,fontWeight:"bold"},actions:{flexDirection:"row",gap:10,marginTop:30,marginBottom:50},btn:{flex:1,padding:18,borderRadius:12,alignItems:"center"},btnT:{color:"#fff",fontWeight:"bold"}}),ge="#f4f7f6",xe="#4a61dd",me="#4CAF50",be="#666666",ye="#eeeeee",pe="#333",je="#666",Ce="#ff5c8a",De="#4CAF50",Te="#E53935",Se="#7E57C2",Ae=["A","B","C","D"];function we({employees:e=[],schedules:t=[],onSave:r,onUpdate:o,onBack:l}){const[d,s]=(0,a.useState)(""),[c,f]=(0,a.useState)(!1),[u,j]=(0,a.useState)(!1),[D,T]=(0,a.useState)(null),[S,A]=(0,a.useState)(!1),[w,I]=(0,a.useState)(""),[k,v]=(0,a.useState)(""),[B,R]=(0,a.useState)(""),[O,F]=(0,a.useState)(!0),[L,W]=(0,a.useState)("A"),z=()=>{I(""),v(""),R(""),F(!0),W("A"),T(null)},M=(e||[]).filter(e=>e.nome?.toLowerCase().includes(d.toLowerCase())||e.matricula?.toString().includes(d));return(0,C.jsxs)(h.default,{style:Ie.container,children:[(0,C.jsxs)(n.default,{style:Ie.header,children:[(0,C.jsx)(m.default,{onPress:l,style:Ie.backButton,children:(0,C.jsx)(g.default,{style:Ie.backButtonText,children:"\u25c0 Voltar"})}),(0,C.jsx)(g.default,{style:Ie.title,children:"Gest\xe3o de Colaboradores"})]}),(0,C.jsxs)(n.default,{style:Ie.searchBarContainer,children:[(0,C.jsx)(x.default,{style:Ie.searchInput,placeholder:"Pesquisar...",value:d,onChangeText:s}),(0,C.jsx)(m.default,{style:Ie.addButton,onPress:()=>{z(),A(!1),f(!0)},children:(0,C.jsx)(g.default,{style:Ie.addButtonText,children:"+ Novo"})})]}),(0,C.jsx)(b.default,{data:M,keyExtractor:e=>e.id.toString(),renderItem:({item:e})=>(0,C.jsxs)(n.default,{style:Ie.empCard,children:[(0,C.jsxs)(n.default,{style:{flex:1},children:[(0,C.jsxs)(n.default,{style:Ie.rowAlign,children:[(0,C.jsx)(g.default,{style:Ie.empName,children:e.nome}),(0,C.jsx)(n.default,{style:[Ie.badge,{backgroundColor:e.status?De:Te}],children:(0,C.jsx)(g.default,{style:Ie.badgeText,children:e.status?"Ativo":"Inativo"})}),"Ferista"===e.letra&&(0,C.jsx)(n.default,{style:[Ie.badge,{backgroundColor:Se}],children:(0,C.jsx)(g.default,{style:Ie.badgeText,children:"FERISTA"})})]}),(0,C.jsxs)(g.default,{style:Ie.empDetails,children:["Mat: ",e.matricula," | Escala: ",e.letra||"A"]})]}),(0,C.jsxs)(n.default,{style:Ie.empActions,children:[(0,C.jsx)(m.default,{onPress:()=>(T(e),void j(!0)),style:Ie.actionBtn,children:(0,C.jsx)(g.default,{style:{fontSize:18},children:"\ud83d\udcc5"})}),(0,C.jsx)(m.default,{onPress:()=>{return T(t=e),I(t.nome),v(t.matricula),R(t.admissao),F(!0===t.status),W(t.letra||"A"),A(!0),void f(!0);var t},style:Ie.actionBtn,children:(0,C.jsx)(g.default,{style:{fontSize:18},children:"\ud83d\udcdd"})})]})]}),contentContainerStyle:{paddingHorizontal:20,paddingBottom:100},ListEmptyComponent:(0,C.jsx)(g.default,{style:Ie.emptyText,children:"Nenhum funcion\xe1rio encontrado."})}),(0,C.jsx)(p.default,{visible:c,transparent:!0,animationType:"slide",children:(0,C.jsx)(n.default,{style:Ie.modalOverlay,children:(0,C.jsxs)(n.default,{style:Ie.modalContent,children:[(0,C.jsxs)(g.default,{style:Ie.modalHeader,children:[S?"Editar":"Cadastrar"," Colaborador"]}),(0,C.jsxs)(y.default,{showsVerticalScrollIndicator:!1,children:[(0,C.jsx)(g.default,{style:Ie.label,children:"Nome Completo"}),(0,C.jsx)(x.default,{style:Ie.input,value:w,onChangeText:I,placeholder:"Nome"}),(0,C.jsxs)(n.default,{style:Ie.row,children:[(0,C.jsxs)(n.default,{style:{flex:1},children:[(0,C.jsx)(g.default,{style:Ie.label,children:"Matr\xedcula"}),(0,C.jsx)(x.default,{style:Ie.input,value:k,onChangeText:v,keyboardType:"numeric"})]}),(0,C.jsx)(n.default,{style:{width:10}}),(0,C.jsxs)(n.default,{style:{flex:1},children:[(0,C.jsx)(g.default,{style:Ie.label,children:"Admiss\xe3o"}),(0,C.jsx)(x.default,{style:Ie.input,value:B,onChangeText:R,placeholder:"DD/MM/AAAA",maxLength:10})]})]}),(0,C.jsx)(g.default,{style:Ie.label,children:"Grupo de Escala"}),(0,C.jsx)(n.default,{style:Ie.optionRow,children:Ae.map(e=>(0,C.jsx)(m.default,{style:[Ie.optionBtn,L===e&&Ie.optionBtnActive],onPress:()=>W(e),children:(0,C.jsx)(g.default,{style:[Ie.optionText,L===e&&Ie.optionTextActive],children:e})},e))}),(0,C.jsx)(m.default,{style:[Ie.feristaBtn,"Ferista"===L&&Ie.feristaBtnActive],onPress:()=>W("Ferista"),children:(0,C.jsx)(g.default,{style:[Ie.optionText,"Ferista"===L&&Ie.optionTextActive],children:"FERISTA (Volante)"})}),(0,C.jsx)(g.default,{style:Ie.label,children:"Status do Colaborador"}),(0,C.jsxs)(n.default,{style:Ie.optionRow,children:[(0,C.jsx)(m.default,{style:[Ie.statusToggle,O&&Ie.btnAtivo],onPress:()=>F(!0),children:(0,C.jsx)(g.default,{style:[Ie.optionText,O&&Ie.optionTextActive],children:"Ativo"})}),(0,C.jsx)(m.default,{style:[Ie.statusToggle,!O&&Ie.btnInativo],onPress:()=>F(!1),children:(0,C.jsx)(g.default,{style:[Ie.optionText,!O&&Ie.optionTextActive],children:"Inativo"})})]}),(0,C.jsxs)(n.default,{style:Ie.modalFooter,children:[(0,C.jsx)(m.default,{style:[Ie.btn,{backgroundColor:be}],onPress:()=>f(!1),children:(0,C.jsx)(g.default,{style:Ie.btnT,children:"Cancelar"})}),(0,C.jsx)(m.default,{style:[Ie.btn,{backgroundColor:me}],onPress:()=>{if(!w||!k||10!==B.length)return void i.default.alert("Erro","Preencha todos os campos corretamente.");const e={nome:w,matricula:k,admissao:B,status:O,letra:L};S&&D?o(Object.assign({},e,{id:D.id})):r(e),f(!1),z()},children:(0,C.jsx)(g.default,{style:Ie.btnT,children:"Salvar"})})]})]})]})})}),(0,C.jsx)(p.default,{visible:u,transparent:!0,animationType:"fade",children:(0,C.jsx)(n.default,{style:Ie.modalOverlay,children:(0,C.jsxs)(n.default,{style:Ie.modalContent,children:[(0,C.jsxs)(g.default,{style:Ie.modalHeader,children:["Hist\xf3rico: ",D?.nome]}),(0,C.jsx)(y.default,{style:{maxHeight:300,marginVertical:15},children:(t||[]).filter(e=>e.employeeId===D?.id).map(e=>(0,C.jsxs)(n.default,{style:Ie.vacationItem,children:[(0,C.jsx)(n.default,{style:Ie.vacationIndicator}),(0,C.jsxs)(n.default,{children:[(0,C.jsxs)(g.default,{style:Ie.vacDate,children:[e.startDate," at\xe9 ",e.endDate]}),(0,C.jsxs)(g.default,{style:Ie.vacInfo,children:[e.durationDays," dias"]})]})]},e.id))}),(0,C.jsx)(m.default,{style:[Ie.btn,{backgroundColor:xe}],onPress:()=>j(!1),children:(0,C.jsx)(g.default,{style:Ie.btnT,children:"Fechar"})})]})})})]})}const Ie=d.default.create({container:{flex:1,backgroundColor:ge},header:{padding:16,flexDirection:"row",alignItems:"center",backgroundColor:"#fff",borderBottomWidth:1,borderColor:ye},backButton:{backgroundColor:xe,paddingVertical:8,paddingHorizontal:12,borderRadius:8},backButtonText:{color:"#FFF",fontWeight:"bold"},title:{fontSize:18,fontWeight:"bold",marginLeft:15},searchBarContainer:{flexDirection:"row",padding:15,gap:10},searchInput:{flex:1,backgroundColor:"#fff",padding:12,borderRadius:10,borderWidth:1,borderColor:ye},addButton:{backgroundColor:me,paddingHorizontal:15,borderRadius:10,justifyContent:"center"},addButtonText:{color:"#fff",fontWeight:"bold"},empCard:{backgroundColor:"#fff",padding:15,borderRadius:12,flexDirection:"row",alignItems:"center",marginBottom:10,marginHorizontal:20,elevation:2},rowAlign:{flexDirection:"row",alignItems:"center",gap:8,flexWrap:"wrap"},empName:{fontSize:15,fontWeight:"bold"},badge:{paddingHorizontal:6,paddingVertical:2,borderRadius:4},badgeText:{color:"#fff",fontSize:10,fontWeight:"bold"},empDetails:{fontSize:12,color:je,marginTop:4},empActions:{flexDirection:"row",gap:12},actionBtn:{padding:5},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},modalContent:{backgroundColor:"#fff",width:"90%",borderRadius:25,padding:25,maxHeight:"80%"},modalHeader:{fontSize:18,fontWeight:"bold",textAlign:"center",marginBottom:20},label:{fontSize:12,fontWeight:"bold",color:je,marginBottom:5,marginTop:15},input:{backgroundColor:"#f9f9f9",borderWidth:1,borderColor:ye,padding:12,borderRadius:10},row:{flexDirection:"row"},optionRow:{flexDirection:"row",justifyContent:"space-between",marginTop:5},optionBtn:{width:"22%",padding:12,borderRadius:10,borderWidth:1,borderColor:ye,alignItems:"center"},optionBtnActive:{backgroundColor:xe,borderColor:xe},feristaBtn:{width:"100%",marginTop:10,padding:12,borderRadius:10,borderWidth:1,borderColor:ye,alignItems:"center",borderStyle:"dashed"},feristaBtnActive:{backgroundColor:Se,borderColor:Se,borderStyle:"solid"},optionText:{fontWeight:"bold",color:pe},optionTextActive:{color:"#fff"},statusToggle:{width:"48%",padding:12,borderRadius:10,borderWidth:1,borderColor:ye,alignItems:"center"},btnAtivo:{backgroundColor:De,borderColor:De},btnInativo:{backgroundColor:Te,borderColor:Te},modalFooter:{flexDirection:"row",gap:10,marginTop:30},btn:{flex:1,padding:15,borderRadius:12,alignItems:"center"},btnT:{color:"#fff",fontWeight:"bold"},vacationItem:{flexDirection:"row",alignItems:"center",backgroundColor:"#f9f9f9",padding:12,borderRadius:10,marginBottom:8},vacationIndicator:{width:4,height:20,backgroundColor:Ce,marginRight:12,borderRadius:2},vacDate:{fontSize:13,fontWeight:"bold"},vacInfo:{fontSize:11,color:je},emptyText:{textAlign:"center",color:"#999",marginTop:10}}),ke="#ffffff",ve="#f8f8f8",Be="#333333",Re="#666666",Oe="#eeeeee",Fe="#4a61dd",Le="#2196f3",We=["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];function ze({data:e,schedules:t=[],onBack:r}){const[o,l]=(0,a.useState)((new Date).getFullYear()),{months:d=We}=e||{},i=Array.from({length:12},()=>[]);return Array.isArray(t)&&t.forEach(e=>{const t=function(e){if(!e)return new Date("Invalid Date");if(e instanceof Date)return e;if("string"===typeof e&&e.includes("/")){const[t,r,o]=e.split("/").map(Number);return new Date(o,r-1,t)}return new Date(e)}(e.startDate);if(!isNaN(t.getTime())&&t.getFullYear()===o){const r=t.getMonth();i[r].push(e)}}),(0,C.jsxs)(h.default,{style:Me.container,children:[(0,C.jsxs)(n.default,{style:Me.header,children:[(0,C.jsx)(m.default,{onPress:r,style:Me.backButton,children:(0,C.jsx)(g.default,{style:Me.backButtonText,children:"\u2190 Voltar"})}),(0,C.jsxs)(g.default,{style:Me.title,children:["Vis\xe3o Mensal ",o]})]}),(0,C.jsxs)(n.default,{style:Me.yearNav,children:[(0,C.jsx)(m.default,{onPress:()=>l(e=>e-1),style:Me.yearBtn,children:(0,C.jsx)(g.default,{style:Me.yearBtnText,children:"<<"})}),(0,C.jsx)(g.default,{style:Me.currentYearText,children:o}),(0,C.jsx)(m.default,{onPress:()=>l(e=>e+1),style:Me.yearBtn,children:(0,C.jsx)(g.default,{style:Me.yearBtnText,children:">>"})})]}),(0,C.jsx)(y.default,{contentContainerStyle:Me.scrollContent,children:d.map((e,t)=>(0,C.jsxs)(n.default,{style:Me.monthSection,children:[(0,C.jsx)(g.default,{style:Me.monthTitle,children:e}),(0,C.jsxs)(n.default,{style:[Me.card,Me.schCard],children:[(0,C.jsxs)(n.default,{style:Me.cardHeader,children:[(0,C.jsx)(g.default,{style:Me.cardTitleSch,children:"F\xc9RIAS MARCADAS"}),(0,C.jsx)(n.default,{style:[Me.badge,{backgroundColor:Le}],children:(0,C.jsx)(g.default,{style:Me.badgeText,children:i[t]?.length||0})})]}),i[t]&&0!==i[t].length?i[t].map((e,t)=>(0,C.jsxs)(n.default,{style:Me.itemLine,children:[(0,C.jsx)(g.default,{style:Me.itemName,children:e.employeeName}),(0,C.jsxs)(g.default,{style:Me.itemDetail,children:[e.startDate," \u2192 ",e.durationDays," dias"]})]},t)):(0,C.jsx)(g.default,{style:Me.emptyText,children:"Nenhum agendamento."})]})]},e))})]})}const Me=d.default.create({container:{flex:1,backgroundColor:ke},header:{padding:16,flexDirection:"row",alignItems:"center",backgroundColor:ve,borderBottomWidth:1,borderColor:Oe},backButton:{backgroundColor:Fe,paddingVertical:6,paddingHorizontal:12,borderRadius:6},backButtonText:{color:"#FFF",fontWeight:"bold"},title:{fontSize:18,fontWeight:"bold",color:Be,marginLeft:15},yearNav:{flexDirection:"row",justifyContent:"center",alignItems:"center",padding:10,backgroundColor:"#FFF",gap:30,borderBottomWidth:1,borderColor:Oe},yearBtn:{padding:10},yearBtnText:{fontSize:20,fontWeight:"bold",color:Fe},currentYearText:{fontSize:22,fontWeight:"900",color:Be},scrollContent:{padding:15},monthSection:{marginBottom:25},monthTitle:{fontSize:20,fontWeight:"bold",color:Be,marginBottom:10,borderLeftWidth:4,borderLeftColor:Fe,paddingLeft:10},card:{backgroundColor:"#FFF",borderRadius:10,padding:12,marginBottom:8,borderWidth:1,borderColor:Oe,elevation:2,shadowColor:"#000",shadowOpacity:.05,shadowRadius:3},schCard:{borderTopWidth:3,borderTopColor:Le},cardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},cardTitleSch:{fontSize:12,fontWeight:"bold",color:Le},badge:{borderRadius:12,minWidth:24,height:24,justifyContent:"center",alignItems:"center",paddingHorizontal:6},badgeText:{color:"#FFF",fontSize:12,fontWeight:"bold"},emptyText:{color:Re,fontSize:12,fontStyle:"italic"},itemLine:{paddingVertical:6,borderBottomWidth:1,borderBottomColor:Oe},itemName:{fontSize:14,fontWeight:"600",color:Be},itemDetail:{fontSize:12,color:Re}}),Ee=["id"],Ne={A:new Date(2025,11,27),B:new Date(2025,11,29),C:new Date(2025,11,31),D:new Date(2026,0,2)},Pe=e=>{if(!e)return null;try{const t="string"===typeof e?e.split("T")[0]:e,[r,o,l]=t.split("-").map(Number),a=new Date(r,o-1,l);return a.setHours(0,0,0,0),isNaN(a.getTime())?null:a}catch(t){return null}},He=e=>{if(!e)return"A";const t=e.letra?.toUpperCase();if(["A","B","C","D"].includes(t))return t;const r=e.nome?.match(/Letra\s([A-D])/i);return r?r[1].toUpperCase():"A"},Ge=(e,t)=>{const r=Ne[t]||Ne.A,o=e.getTime()-r.getTime();return(Math.floor(o/864e5)%8+8)%8<4?"TRABALHO":"FOLGA"};const Ve=d.default.create({container:{flex:1,backgroundColor:"#fff"},center:{flex:1,justifyContent:"center",alignItems:"center"}});(0,o.default)(function(){const[e,t]=(0,a.useState)("HOME"),[r,o]=(0,a.useState)([]),[d,c]=(0,a.useState)([]),[f,h]=(0,a.useState)(null),[g,x]=(0,a.useState)(!0),m=async()=>{x(!0);try{const{data:e}=await u.from("employees").select("*").order("nome"),{data:t}=await u.from("schedules").select("*");o(e||[]),c(t||[])}catch(e){i.default.alert("Erro","Erro ao carregar dados.")}finally{x(!1)}};(0,a.useEffect)(()=>{m()},[]);const b=(0,a.useMemo)(()=>((e,t)=>{if(!e||0===e.length)return{};const r={},o=[...e].sort((e,t)=>{const r=Pe(e.data_inicio||e.startDate),o=Pe(t.data_inicio||t.startDate);return(r?.getTime()||0)-(o?.getTime()||0)});return o.forEach((e,l)=>{const a=Pe(e.data_inicio||e.startDate);if(!a)return;const n=t.find(t=>t.id===(e.employee_id||e.employeeId)),d=He(n),i=l>0?o[l-1]:null,s=i?Pe(i.data_fim||i.endDate):null,c=i?t.find(e=>e.id===(i.employee_id||i.employeeId)):null,f=c?He(c):null;let u=new Date(a);for(let t=1;t<=8&&(u.setDate(u.getDate()-1),!(s&&u<=s));t++){const e=u.toISOString().split("T")[0];if("TRABALHO"===Ge(u,d))r[e]={tipo:"FOLGA",descricao:"Descanso Pr\xe9-Escala"};else if(f){const t=Ge(u,f);r[e]="TRABALHO"===t?{tipo:"TRABALHO",descricao:`Ponte Letra ${f}`}:{tipo:"FOLGA",descricao:"Folga Dupla"}}else r[e]={tipo:"FOLGA",descricao:"Sem Cobertura"}}}),r})(d,r),[d,r]);return g?(0,C.jsx)(n.default,{style:Ve.center,children:(0,C.jsx)(s.default,{size:"large",color:"#4a61dd"})}):(0,C.jsxs)(n.default,{style:Ve.container,children:["HOME"===e&&(0,C.jsx)(P,{employees:r,schedules:d,feristaData:b,onOpenRegister:()=>t("FUNCIONARIOS"),onOpenMonthly:()=>t("MENSAL"),onOpenSchedule:e=>{h(e),t(e?"EDITAR":"AGENDAR")},onDeleteSchedules:async e=>{await u.from("schedules").delete().in("id",e),m()}}),"AGENDAR"===e&&(0,C.jsx)(Z,{employees:r,onSchedule:async e=>{const{error:r}=await u.from("schedules").insert([e]);r||(await m(),t("HOME"))},onCancel:()=>t("HOME")}),"EDITAR"===e&&(0,C.jsx)(ue,{scheduleToEdit:f,employees:r,onUpdate:async e=>{const{id:r}=e,o=(0,l.default)(e,Ee),{error:a}=await u.from("schedules").update(o).eq("id",r);a||(await m(),t("HOME"))},onCancel:()=>t("HOME")}),"FUNCIONARIOS"===e&&(0,C.jsx)(we,{employees:r,onBack:()=>t("HOME"),onSave:m,onUpdate:m}),"MENSAL"===e&&(0,C.jsx)(ze,{employees:r,schedules:d,feristaData:b,onBack:()=>t("HOME")})]})})}},t={};function r(o){var l=t[o];if(void 0!==l)return l.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}r.m=e,(()=>{var e=[];r.O=(t,o,l,a)=>{if(!o){var n=1/0;for(c=0;c<e.length;c++){for(var[o,l,a]=e[c],d=!0,i=0;i<o.length;i++)(!1&a||n>=a)&&Object.keys(r.O).every(e=>r.O[e](o[i]))?o.splice(i--,1):(d=!1,a<n&&(n=a));if(d){e.splice(c--,1);var s=l();void 0!==s&&(t=s)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[o,l,a]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,o)=>{var l,a,[n,d,i]=o,s=0;if(n.some(t=>0!==e[t])){for(l in d)r.o(d,l)&&(r.m[l]=d[l]);if(i)var c=i(r)}for(t&&t(o);s<n.length;s++)a=n[s],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},o=self.webpackChunkweb=self.webpackChunkweb||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=r.O(void 0,[559],()=>r(1522));o=r.O(o)})();
//# sourceMappingURL=main.411ac5e9.js.map